<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ú¯Ø°Ø± Ø²Ù…Ø§Ù† - Ù‡Ø± Ù„Ø­Ø¸Ù‡ Ø§Ø±Ø²Ø´Ù…Ù†Ø¯ Ø§Ø³Øª</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Vazirmatn:wght@100;300;400;500;700;900&display=swap');
    
    /* ØªÙ… Ø´Ø¨ (Ù¾ÛŒØ´â€ŒÙØ±Ø¶) */
    :root {
      --primary-color: #e6c229;
      --dark-primary: #d4a017;
      --warning-color: #e74c3c;
      --bg-color: #1a1a2e;
      --text-color: #f8f8f8;
      --glass-bg: rgba(26, 26, 46, 0.85);
      --glass-border: rgba(230, 194, 41, 0.3);
      --particle-color: #e6c229;
    }
    
    /* ØªÙ… Ø±ÙˆØ² */
    .day-theme {
      --primary-color: #3498db;
      --dark-primary: #2980b9;
      --warning-color: #e74c3c;
      --bg-color: #f5f7fa;
      --text-color: #2c3e50;
      --glass-bg: rgba(245, 247, 250, 0.85);
      --glass-border: rgba(52, 152, 219, 0.3);
      --particle-color: #3498db;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      font-family: 'Vazirmatn', sans-serif;
      background: var(--bg-color);
      color: var(--text-color);
      overflow: hidden;
      position: relative;
      transition: all 0.5s ease;
    }
    
    /* Ø§ÙÚ©Øª Ø°Ø±Ø§Øª Ø¯Ø± Ø­Ø§Ù„ Ø­Ø±Ú©Øª */
    .time-particle {
      position: absolute;
      width: 2px;
      height: 2px;
      background: var(--particle-color);
      border-radius: 50%;
      filter: blur(0.5px);
      animation: float 15s linear infinite;
      z-index: -1;
      opacity: 0.6;
    }
    
    #timer {
      background: var(--glass-bg);
      padding: 2.5rem;
      border-radius: 1.5rem;
      box-shadow: 0 0 30px rgba(230, 194, 41, 0.2);
      text-align: center;
      backdrop-filter: blur(10px);
      border: 1px solid var(--glass-border);
      width: 90%;
      max-width: 500px;
      position: relative;
      overflow: hidden;
      transition: all 0.3s ease;
    }
    
    .day-theme #timer {
      box-shadow: 0 0 30px rgba(52, 152, 219, 0.2);
    }
    
    #timer:hover {
      transform: scale(1.02);
      box-shadow: 0 0 40px rgba(230, 194, 41, 0.3);
    }
    
    .day-theme #timer:hover {
      box-shadow: 0 0 40px rgba(52, 152, 219, 0.3);
    }
    
    #timer::before {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 5px;
      background: linear-gradient(90deg, var(--primary-color), var(--dark-primary), var(--primary-color));
      background-size: 200% 100%;
      animation: gradient-flow 4s linear infinite;
    }
    
    #countdown {
      font-size: 4.5rem;
      margin: 1.5rem 0;
      font-weight: 700;
      color: var(--primary-color);
      letter-spacing: 2px;
      text-shadow: 0 0 10px rgba(230, 194, 41, 0.3);
      font-variant-numeric: tabular-nums;
    }
    
    .day-theme #countdown {
      text-shadow: 0 0 10px rgba(52, 152, 219, 0.3);
    }
    
    .timer-title {
      font-size: 1.4rem;
      margin-bottom: 1rem;
      font-weight: 500;
      color: var(--text-color);
      line-height: 1.6;
    }
    
    .philosophy-text {
      color: var(--text-color);
      opacity: 0.8;
      font-weight: 300;
      margin: 1.2rem 0;
      font-size: 1rem;
      line-height: 1.8;
      transition: all 0.3s ease;
    }
    
    .time-progress {
      width: 100%;
      height: 8px;
      background: rgba(0, 0, 0, 0.1);
      border-radius: 4px;
      margin: 1.5rem 0;
      overflow: hidden;
    }
    
    .day-theme .time-progress {
      background: rgba(0, 0, 0, 0.05);
    }
    
    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, var(--primary-color), var(--dark-primary));
      border-radius: 4px;
      transition: width 1s linear, background 0.5s ease;
    }
    
    /* Ø¯Ú©Ù…Ù‡ ØªØºÛŒÛŒØ± ØªÙ… */
    .theme-toggle {
      position: absolute;
      top: 20px;
      left: 20px;
      background: var(--glass-bg);
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-color);
      font-size: 1.2rem;
      transition: all 0.3s ease;
      backdrop-filter: blur(5px);
      border: 1px solid var(--glass-border);
    }
    
    .theme-toggle:hover {
      background: rgba(255, 255, 255, 0.25);
      transform: rotate(30deg);
    }
    
    /* Ø§Ù†ÛŒÙ…ÛŒØ´Ù†â€ŒÙ‡Ø§ */
    @keyframes float {
      0% { transform: translateY(0) translateX(0); opacity: 0; }
      10% { opacity: 0.6; }
      90% { opacity: 0.6; }
      100% { transform: translateY(-100vh) translateX(20px); opacity: 0; }
    }
    
    @keyframes gradient-flow {
      0% { background-position: 0% 50%; }
      100% { background-position: 100% 50%; }
    }
    
    @keyframes pulse-soft {
      0% { transform: scale(1); box-shadow: 0 0 30px rgba(230, 194, 41, 0.2); }
      50% { transform: scale(1.02); box-shadow: 0 0 50px rgba(230, 194, 41, 0.4); }
      100% { transform: scale(1); box-shadow: 0 0 30px rgba(230, 194, 41, 0.2); }
    }
    
    .day-theme #timer {
      animation: pulse-soft-day 2s ease;
    }
    
    @keyframes pulse-soft-day {
      0% { transform: scale(1); box-shadow: 0 0 30px rgba(52, 152, 219, 0.2); }
      50% { transform: scale(1.02); box-shadow: 0 0 50px rgba(52, 152, 219, 0.4); }
      100% { transform: scale(1); box-shadow: 0 0 30px rgba(52, 152, 219, 0.2); }
    }
    
    @keyframes warning-pulse {
      0% { text-shadow: 0 0 10px rgba(231, 76, 60, 0.3); }
      50% { text-shadow: 0 0 20px rgba(231, 76, 60, 0.6); }
      100% { text-shadow: 0 0 10px rgba(231, 76, 60, 0.3); }
    }
    
    /* Ø±ÛŒØ³Ù¾Ø§Ù†Ø³ÛŒÙˆ */
    @media (max-width: 768px) {
      #timer {
        padding: 1.8rem;
      }
      
      #countdown {
        font-size: 3.5rem;
      }
    }
  </style>
</head>
<body>
  <div id="timer">
    <button class="theme-toggle" id="themeToggle">ğŸŒ™</button>
    <h2 class="timer-title">Ø²Ù…Ø§Ù† Ø¯Ø± Ø­Ø§Ù„ Ú¯Ø°Ø± Ø§Ø³Øª...</h2>
    <p class="philosophy-text" id="philosophy-text">Ù‡Ø± Ø«Ø§Ù†ÛŒÙ‡â€ŒØ§ÛŒ Ú©Ù‡ Ù…ÛŒâ€ŒÚ¯Ø°Ø±Ø¯ØŒ ÙØ±ØµØªÛŒ Ø§Ø³Øª Ú©Ù‡ Ø¯ÛŒÚ¯Ø± ØªÚ©Ø±Ø§Ø± Ù†Ù…ÛŒâ€ŒØ´ÙˆØ¯</p>
    
    <div class="time-progress">
      <div class="progress-bar" id="progress-bar"></div>
    </div>
    
    <h1 id="countdown">00:00:00</h1>
  </div>

  <script>
    // ØªÙ†Ø¸ÛŒÙ…Ø§Øª ØªØ§ÛŒÙ…Ø±
    const TARGET_HOUR = 22;
    const TARGET_MINUTE = 22;
    const philosophyText = document.getElementById('philosophy-text');
    const progressBar = document.getElementById('progress-bar');
    const themeToggle = document.getElementById('themeToggle');
    
    // Ø§ÛŒØ¬Ø§Ø¯ Ø°Ø±Ø§Øª Ø´Ù†Ø§ÙˆØ± Ø¯Ø± Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡
    function createTimeParticles() {
      const particle = document.createElement('div');
      particle.className = 'time-particle';
      particle.style.left = `${Math.random() * 100}%`;
      particle.style.top = `${Math.random() * 100}%`;
      particle.style.width = `${1 + Math.random() * 3}px`;
      particle.style.height = particle.style.width;
      particle.style.animationDuration = `${10 + Math.random() * 20}s`;
      document.body.appendChild(particle);
      
      // Ø­Ø°Ù Ø°Ø±Ù‡ Ø¨Ø¹Ø¯ Ø§Ø² Ø§ØªÙ…Ø§Ù… Ø§Ù†ÛŒÙ…ÛŒØ´Ù†
      setTimeout(() => {
        particle.remove();
      }, 30000);
    }
    
    // ØªØºÛŒÛŒØ± ØªÙ… Ø¨Ø± Ø§Ø³Ø§Ø³ Ø²Ù…Ø§Ù† Ø§ÛŒØ±Ø§Ù†
    function updateThemeByTime() {
      const now = new Date();
      const tehranOffset = 3.5 * 60 * 60 * 1000; // Ø§ÛŒØ±Ø§Ù† UTC+3:30
      const localOffset = now.getTimezoneOffset() * 60 * 1000;
      const tehranNow = new Date(now.getTime() + localOffset + tehranOffset);
      const hours = tehranNow.getHours();
      
      // Ø¨ÛŒÙ† Ø³Ø§Ø¹Øª 6 ØµØ¨Ø­ ØªØ§ 6 Ø¹ØµØ± ØªÙ… Ø±ÙˆØ²
      if (hours >= 6 && hours < 18) {
        document.body.classList.add('day-theme');
        themeToggle.textContent = 'ğŸŒ™';
      } else {
        document.body.classList.remove('day-theme');
        themeToggle.textContent = 'â˜€ï¸';
      }
    }
    
    // ØªØºÛŒÛŒØ± ØªÙ… Ø¯Ø³ØªÛŒ
    themeToggle.addEventListener('click', () => {
      document.body.classList.toggle('day-theme');
      if (document.body.classList.contains('day-theme')) {
        themeToggle.textContent = 'ğŸŒ™';
        localStorage.setItem('themePreference', 'day');
      } else {
        themeToggle.textContent = 'â˜€ï¸';
        localStorage.setItem('themePreference', 'night');
      }
    });
    
    // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØªÙ… Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù‡
    function loadSavedTheme() {
      const savedTheme = localStorage.getItem('themePreference');
      if (savedTheme === 'day') {
        document.body.classList.add('day-theme');
        themeToggle.textContent = 'ğŸŒ™';
      } else if (savedTheme === 'night') {
        document.body.classList.remove('day-theme');
        themeToggle.textContent = 'â˜€ï¸';
      } else {
        updateThemeByTime();
      }
    }
    
    // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø²Ù…Ø§Ù† Ø¨Ø§Ù‚ÛŒÙ…Ø§Ù†Ø¯Ù‡ ØªØ§ 22:22 ÙØ±Ø¯Ø§
    function calculateRemainingTime() {
      const now = new Date();
      const tehranOffset = 3.5 * 60 * 60 * 1000; // Ø§ÛŒØ±Ø§Ù† UTC+3:30
      const localOffset = now.getTimezoneOffset() * 60 * 1000;
      const tehranNow = new Date(now.getTime() + localOffset + tehranOffset);
      
      // Ø²Ù…Ø§Ù† Ù‡Ø¯Ù Ø§Ù…Ø±ÙˆØ²
      const targetTime = new Date(tehranNow);
      targetTime.setHours(TARGET_HOUR, TARGET_MINUTE, 0, 0);
      
      // Ø§Ú¯Ø± Ø²Ù…Ø§Ù† Ù‡Ø¯Ù Ú¯Ø°Ø´ØªÙ‡ØŒ Ø¨Ø±Ø§ÛŒ ÙØ±Ø¯Ø§ ØªÙ†Ø¸ÛŒÙ… Ú©Ù†
      if (tehranNow >= targetTime) {
        targetTime.setDate(targetTime.getDate() + 1);
      }
      
      const diff = targetTime - tehranNow;
      const totalHours = 24;
      const remainingHours = diff / (1000 * 60 * 60);
      const percent = (remainingHours / totalHours) * 100;
      
      return { diff, percent };
    }
    
    // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù†Ù…Ø§ÛŒØ´ ØªØ§ÛŒÙ…Ø±
    function updateTimer() {
      const { diff, percent } = calculateRemainingTime();
      
      // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù†ÙˆØ§Ø± Ù¾ÛŒØ´Ø±ÙØª
      progressBar.style.width = `${percent}%`;
      
      // ØªØºÛŒÛŒØ± Ø±Ù†Ú¯ Ù†ÙˆØ§Ø± Ù¾ÛŒØ´Ø±ÙØª Ø¯Ø± Ø²Ù…Ø§Ù† Ú©Ù…
      if(percent < 10) {
        progressBar.style.background = 'linear-gradient(90deg, var(--warning-color), #c0392b)';
        document.getElementById('countdown').style.animation = 'warning-pulse 1.5s infinite';
        philosophyText.textContent = 'Ø²Ù…Ø§Ù† Ø¯Ø± Ø­Ø§Ù„ Ø§ØªÙ…Ø§Ù… Ø§Ø³Øª! Ø§Ø² Ù„Ø­Ø¸Ø§Øª Ø¨Ø§Ù‚ÛŒÙ…Ø§Ù†Ø¯Ù‡ Ù†Ù‡Ø§ÛŒØª Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø±Ø§ Ø¨Ú©Ù†';
        philosophyText.style.color = 'rgba(231, 76, 60, 0.9)';
      } else if(percent < 30) {
        progressBar.style.background = 'linear-gradient(90deg, #f39c12, #e67e22)';
        document.getElementById('countdown').style.animation = '';
        philosophyText.textContent = 'Ø²Ù…Ø§Ù† Ø¨Ù‡ Ø³Ø±Ø¹Øª Ù…ÛŒâ€ŒÚ¯Ø°Ø±Ø¯... Ù„Ø­Ø¸Ø§ØªØª Ø±Ø§ Ù‡ÙˆØ´Ù…Ù†Ø¯Ø§Ù†Ù‡ Ø³Ù¾Ø±ÛŒ Ú©Ù†';
        philosophyText.style.color = 'rgba(243, 156, 18, 0.9)';
      } else {
        progressBar.style.background = 'linear-gradient(90deg, var(--primary-color), var(--dark-primary))';
        document.getElementById('countdown').style.animation = '';
        philosophyText.textContent = 'Ù‡Ø± Ø«Ø§Ù†ÛŒÙ‡â€ŒØ§ÛŒ Ú©Ù‡ Ù…ÛŒâ€ŒÚ¯Ø°Ø±Ø¯ØŒ ÙØ±ØµØªÛŒ Ø§Ø³Øª Ú©Ù‡ Ø¯ÛŒÚ¯Ø± ØªÚ©Ø±Ø§Ø± Ù†Ù…ÛŒâ€ŒØ´ÙˆØ¯';
        philosophyText.style.color = 'rgba(248, 248, 248, 0.8)';
      }
      
      // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø³Ø§Ø¹ØªØŒ Ø¯Ù‚ÛŒÙ‚Ù‡ Ùˆ Ø«Ø§Ù†ÛŒÙ‡
      const hours = Math.floor(diff / (1000 * 60 * 60));
      const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
      const seconds = Math.floor((diff % (1000 * 60)) / 1000);
      
      // Ù†Ù…Ø§ÛŒØ´ Ø¨Ø§ Ø§Ø¹Ø¯Ø§Ø¯ Ø§Ù†Ú¯Ù„ÛŒØ³ÛŒ
      const format = num => String(num).padStart(2, '0');
      document.getElementById('countdown').textContent = `${format(hours)}:${format(minutes)}:${format(seconds)}`;
      
      // ØªØ£Ú©ÛŒØ¯ Ø¨ØµØ±ÛŒ Ø±ÙˆÛŒ Ú¯Ø°Ø± Ø²Ù…Ø§Ù†
      if(minutes % 30 === 0 && seconds === 0) {
        const animationName = document.body.classList.contains('day-theme') ? 'pulse-soft-day' : 'pulse-soft';
        document.getElementById('timer').style.animation = `${animationName} 2s ease`;
        setTimeout(() => {
          document.getElementById('timer').style.animation = '';
        }, 2000);
      }
    }
    
    // Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
    loadSavedTheme();
    updateTimer();
    updateThemeByTime();
    setInterval(updateTimer, 1000);
    
    // Ø¨Ø±Ø±Ø³ÛŒ ØªØºÛŒÛŒØ± ØªÙ… Ù‡Ø± Ø³Ø§Ø¹Øª
    setInterval(updateThemeByTime, 3600000);
    
    // Ø§ÛŒØ¬Ø§Ø¯ Ø°Ø±Ø§Øª Ø²Ù…Ø§Ù† Ø¯Ø± Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡
    setInterval(createTimeParticles, 300);
  </script>
</body>
</html>
